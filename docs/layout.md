# OAS-Layout

OAS-Layout defines the **resolved geometric representation** of an architectural design.  
Unlike OAS-Program (intent) and OAS-Core (schema fundamentals), OAS-Layout provides the **fully computed spatial configuration** of all rooms, walls, openings, and circulation elements using precise millimeter-based geometry.

OAS-Layout is typically generated by:
- Layout solvers
- LLM reasoning tools
- Constraint-based design systems
- Manual editing tools

It represents *what the plan actually is*, in explicit geometric terms.

---

## 1. Purpose of OAS-Layout

OAS-Layout is the bridge between:
- **Programmatic intent** (OAS-Program)
- **Geometry rules** (OAS-Geometry)
- **Visualization** (OAS-Render)

It answers concrete questions like:

- *Where is Bedroom 1 located?*
- *What shape is the living room polygon?*
- *Where is the door placed on the wall?*
- *How do rooms connect?*

While OAS-Core defines the data types, **OAS-Layout defines how all resolved elements come together in one coherent spatial model**.

---

## 2. Layout Document Structure

Example top-level structure:

```json
{
  "oas_layout": "1.0.0",
  "plan_id": "apt_01",
  "rooms": [...],
  "walls": [...],
  "openings": [...],
  "connections": [...],
  "metadata": { ... }
}
```

Sections include:

- **rooms** — geometric room boundaries  
- **walls** — wall segments with thickness  
- **openings** — door/window placement  
- **connections** — circulation graph  
- **metadata** — optional solver/LLM details  

---

## 3. Rooms

Rooms in OAS-Layout must include:

- `id`
- `usage`
- `boundary_polygon` (mm integer coordinates)
- `area_m2` (derived)
- Optional tags

### Example

```json
{
  "id": "room_living_01",
  "usage": "living",
  "boundary_polygon": {
    "unit": "mm",
    "closed": true,
    "points": [
      { "x": 0, "y": 0 },
      { "x": 5000, "y": 0 },
      { "x": 5000, "y": 4000 },
      { "x": 0, "y": 4000 }
    ]
  },
  "area_m2": 20.0,
  "tags": ["daylit"]
}
```

### Requirements

- Polygon must be simple (non-self-intersecting)  
- Polygon must be closed  
- Coordinates must be integers in mm  
- Area must be included or derivable  

---

## 4. Walls

A wall is a straight line segment with thickness and room associations.

### Example

```json
{
  "id": "wall_south",
  "from": { "x": 0, "y": 0 },
  "to":   { "x": 5000, "y": 0 },
  "unit": "mm",
  "thickness_mm": 200,
  "structural": true,
  "adjacent_rooms": ["room_living_01", "room_corridor_01"]
}
```

### Wall Rules

- Endpoints must be valid mm integer points  
- Wall thickness in mm  
- Walls may bound one or two rooms  
- Structural classification optional  
- Must align with room boundaries when adjacent  

---

## 5. Openings (Doors, Windows)

Openings are anchored to walls and positioned along the wall length.

### Example

```json
{
  "id": "door_main",
  "opening_type": "door",
  "in_wall": "wall_south",
  "connects_rooms": ["exterior", "room_living_01"],
  "position_along_wall_mm": 1200,
  "width_mm": 900,
  "height_mm": 2100
}
```

### Rules

- Must reference an existing wall (`in_wall`)  
- Must specify position along the wall  
- Width and height must be integers in mm  
- For windows, additional `sill_height_mm` may be included  

---

## 6. Circulation (Connections)

This defines graph-like connections between rooms.

### Example

```json
{
  "from": "entry",
  "to": "living_kitchen",
  "type": "direct"
}
```

### Circulation Types

- **direct** — rooms share a doorway  
- **through** — route passes through intermediate rooms  
- **single_access** — room accessible only through one other room  

Circulation graphs are useful for:

- accessibility evaluation  
- LLM reasoning  
- layout optimization  

---

## 7. Metadata

Optional metadata for provenance:

```json
{
  "generated_by": "solver_v2.0",
  "timestamp": "2025-01-18T12:45:00Z",
  "notes": "Generated from OAS-Program using constraint solver."
}
```

---

## 8. Relationship to OAS-Program

### OAS-Program → OAS-Layout

OAS-Program defines:

- desired areas  
- adjacency requirements  
- constraints  
- functional goals  

OAS-Layout represents the **actual geometric outcome** that satisfies those conditions.

### Iterative Workflow

1. Start with OAS-Program  
2. Generate OAS-Layout  
3. User updates the program  
4. Layout regenerates  

This enables prompt-based design refinement.

---

## 9. Relationship to OAS-Render

OAS-Render uses OAS-Layout geometry (mm integers) to produce:

- SVG
- Canvas
- WebGL scenes
- PDF outputs

Layout is the authoritative geometric dataset.

---

## 10. Summary

OAS-Layout encodes all *finalized* and *explicit* geometry for architectural designs, including:

- Room boundaries  
- Wall geometry + thickness  
- Door and window placement  
- Circulation relationships  
- Provenance metadata  

It is the **canonical geometric representation** used for visualization, analysis, editing, and downstream applications.
